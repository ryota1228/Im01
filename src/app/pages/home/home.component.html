<div class="dashboard-wrapper">
  <h1>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>

  <div class="home-grid">
    <!-- å·¦ã‚«ãƒ©ãƒ  -->
    <div class="home-main">
      <div class="section">
        <h2>ä»Šæ—¥ãŒæœŸé™ã®ã‚¿ã‚¹ã‚¯</h2><div>ç¾åœ¨æ—¥æ™‚ï¼š{{ currentTime | date: 'MM/dd HH:mm:ss' }}</div>
        <div class="section-scrollable">
        <div *ngIf="isLoading">èª­ã¿è¾¼ã¿ä¸­...</div>
        <ul *ngIf="!isLoading && todaysTasks.length > 0">
          <li *ngFor="let task of todaysTasks" (click)="openTask(task)">
            {{ task.title }}ï¼ˆé€²æ—ç‡ï¼š{{ task.progress }}%ï¼‰
          </li>
        </ul>
        <p *ngIf="!isLoading && todaysTasks.length === 0">ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“</p>
        </div>
      </div>

      <div class="section">
        <h2>æœŸé™è¶…éã‚¿ã‚¹ã‚¯</h2>
        <div class="section-scrollable">
        <ul *ngIf="delayedTasks.length > 0">
          <li *ngFor="let task of delayedTasks" (click)="openTask(task)">
            {{ task.title }}ï¼ˆæœŸé™: {{ task.dueDate | date: 'MM/dd' }}ï¼‰
          </li>
        </ul>
        <p *ngIf="delayedTasks.length === 0">é…å»¶ã—ã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“</p>
        </div>
      </div>

      <div class="section">
        <h2>å‚åŠ ä¸­ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</h2>
        <div class="section-scrollable">
        <ul>
          <li *ngFor="let project of sortedProjects" (click)="goToProject(project.id)">
            <strong>{{ project.title }}</strong>
            ï¼ˆæœŸé™: {{ project.dueDate | date: 'MM/dd' }} / é…å»¶: {{ project.delayedCount }}ä»¶ï¼‰
            <button
              class="pin-button"
              [class.pinned]="project.pinned"
              (click)="togglePin(project.id); $event.stopPropagation();"
            >
              <mat-icon>push_pin</mat-icon>{{ project.pinned ? 'è§£é™¤' : 'ä¸Šéƒ¨ã«å›ºå®š' }}
            </button>
          </li>
        </ul>
        
        </div>
      </div>

      <div class="section">
        <h2>ä»Šé€±ã®ã‚¿ã‚¹ã‚¯</h2>
        <div class="section-scrollable">
        <app-calendar-view
          [mode]="'week'"
          [embedded]="true"
          [currentDate]="currentTime"
          [userId]="uid">
        </app-calendar-view>
        </div>
      </div>
    </div>

    <!-- å³ã‚«ãƒ©ãƒ  -->
    <div class="home-side">
      <!-- <div class="section clock-attendance">
        <h2>ç¾åœ¨æ™‚åˆ»ã¨å‹¤æ€ </h2>
        <div class="section-scrollable">
        <p>{{ currentTime | date: 'yyyy/MM/dd HH:mm:ss' }}</p>
        <p>ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: {{ attendanceStatus }}</p>
        <div class="attendance-buttons">
          <button (click)="setAttendance('å‡ºå‹¤')" [disabled]="attendanceStatus === 'å‡ºå‹¤'">å‡ºå‹¤</button>
          <button (click)="setAttendance('é€€å‹¤')" [disabled]="attendanceStatus === 'é€€å‹¤'">é€€å‹¤</button>
          <button (click)="setAttendance('ä¼‘æ†©')" [disabled]="attendanceStatus === 'ä¼‘æ†©'">ä¼‘æ†©</button>
          <button (click)="setAttendance('å‡ºå‹¤')" [disabled]="attendanceStatus === 'å‡ºå‹¤'">å¾©å¸°</button>
        </div>
        </div>
      </div> -->

      <div class="notification-preview">
        <h2>é€šçŸ¥</h2>
        <div class="section-scrollable">
        <div *ngIf="notifications.length === 0">é€šçŸ¥ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“</div>
        <ul>
          <li *ngFor="let n of notifications | slice:0:5" (click)="onClickNotification(n)">
            <strong>{{ n.taskName }}</strong>ï¼ˆ{{ n.type }}ï¼‰
            <span *ngIf="!n.isRead">ğŸŸ  æœªèª­</span>
          </li>
        </ul>
        <button (click)="goToAllNotifications()">ã™ã¹ã¦è¡¨ç¤º</button>
        </div>
      </div>
    </div>
  </div>
</div>
