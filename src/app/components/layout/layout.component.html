<div class="layout">
  <header class="topbar">
    <button class="toggle-btn" (click)="toggleSidebar()">
      ☰
    </button>

    <div class="topbar-content">
      <ng-container *ngIf="user$ | async as user">
        <span class="user-name">ログイン中のユーザー：{{ displayName }}（{{ user.email }}）</span>
        <button class="logout-button" (click)="logout()">
          <span class="material-icons">logout</span>
          ログアウト
        </button>
      </ng-container>
    </div>
  </header>

  <div class="body-row">
    <aside class="sidebar" [class.closed]="!sidebarOpen">

      <div class="sidebar-content">
        <div class="sidebar-menu-list">

          <div class="notification-wrapper" (click)="toggleNotifications()">
            <span *ngIf="hasUnread" class="notification-badge">●</span>
            <span class="material-icons">notifications</span>
            <span class="notification-label">最新通知</span>
          </div>

          <div *ngIf="showNotifications" class="notification-panel">
            <app-notification-list></app-notification-list>
          </div>

          <a (click)="openNotificationSettings()" class="sidebar-link">
            <span class="material-icons sidebar-icon">settings</span>
            <span>通知設定</span>
          </a>
    
          <a routerLink="/" class="sidebar-link">
            <span class="material-icons sidebar-icon">home</span>
            <span>ホーム</span>
          </a>
          
          <a routerLink="/teams" class="sidebar-link">
            <span class="material-icons sidebar-icon">groups</span>
            <span>チーム</span>
          </a>
    
        </div>
      </div>

      <div class="sidebar-link" (click)="toggleProjectList()">
        <span class="material-icons">folder</span>プロジェクト
        <span class="material-icons arrow">{{ isProjectListOpen ? 'expand_less' : 'expand_more' }}</span>
      </div>
      
      <div *ngIf="isProjectListOpen" class="project-list">
        <a *ngFor="let p of joinedProjects" [routerLink]="['/project', p.id]" class="sidebar-sub-link">{{ p.title }}</a>
      </div>

      <button *ngIf="isProjectListOpen" class="sidebar-link sidebar-sub add-project-btn" (click)="openCreateProjectDialog()">
        ＋ 新規作成
      </button>
      
    </aside>

    <main class="content-scroll">
      <router-outlet></router-outlet>
    </main>
  </div>
</div>




